$(function(){$('#pageMap').live("pageshow",function(){$('#map_canvas').gmap({'center':'40.69302,-75.20845','zoom':16,'disableDefaultUI':true,'callback':function(){var self=this;this.addMarker({'position':'40.69302,-75.20845'});self.set('getCurrentPosition',function(){self.refresh();self.getCurrentPosition(function(position,status){if(status==='OK'){var latlng=new google.maps.LatLng(position.coords.latitude,position.coords.longitude)self.get('map').panTo(latlng);self.search({'location':latlng},function(results,status){if(status==='OK'){$('#from').val(results[0].formatted_address)}})}else{alert('Unable to get current position')}})});$('#submit').click(function(){self.displayDirections({'origin':$('#from').val(),'destination':$('#to').val(),'travelMode':google.maps.DirectionsTravelMode.DRIVING},{'panel':document.getElementById('directions')},function(response,status){(status==='OK')?$('#results').show():$('#results').hide()});return false})}})})});